"use strict";function guessFusioEndpointUrl(){for(var a=window.location.href,b=function(a,b){var c=(a.match(/\//g)||[]).length,d=a.lastIndexOf(b);return c>2&&-1!==d?a.substring(0,d):a},c=["#","?","/","/"],d=0;d<c.length;d++)a=b(a,c[d]);return a+"/index.php/"}var todoControllers=angular.module("todoControllers",[]);todoControllers.controller("TodoListCtrl",["$scope","$http","AccessToken",function(a,b,c){a.todo={title:""},a.todos=[],a.getTodos=function(){b.get(fusio_url+"todo").success(function(b){a.todos=b.entry.map(function(a){return a.insertDate=new Date(a.insertDate).toLocaleString(),a})})},a.insertTodo=function(){var d=c.get(),e={};null!=d&&(e.headers={},e.headers.Authorization="Bearer "+d.access_token),b.post(fusio_url+"todo",a.todo,e).success(function(b){a.response=b,a.todo={title:""},a.getTodos()})},a.removeTodo=function(d){var e=c.get(),f={};null!=e&&(f.headers={},f.headers.Authorization="Bearer "+e.access_token),b["delete"](fusio_url+"todo/"+d.id,f).success(function(b){a.getTodos()})},a.getTodos()}]);var todoApp=angular.module("todoApp",["ngRoute","oauth","todoControllers"]);todoApp.config(function(a){a.html5Mode(!0).hashPrefix("!")}),todoApp.config(["$routeProvider",function(a){a.when("/",{templateUrl:"partials/list.html",controller:"TodoListCtrl"}).when("/:todoId",{templateUrl:"partials/detail.html",controller:"TodoDetailCtrl"}).when("/access_token=:accessToken",{template:"",controller:function(a,b){var c=a.path().substr(1);b.setTokenFromString(c),a.path("/"),a.replace()}}).otherwise({redirectTo:"/"})}]);var fusio_url=guessFusioEndpointUrl();